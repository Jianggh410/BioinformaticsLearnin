# 富集分析 Enrichment analysis

一个生物过程通常是由一组基因共同参与，而不是由单个基因独自完成。富集分析的基本前提假设是，如果一个生物学过程在已知的研究中发生异常，则共同发挥功能的基因极可能被选择出来作为一个与这一过程相关的基因集合。富集分析（Gene Set Enrichment Analysis, GSEA）通常是分析一组基因在某个功能节点上是否相比于随机水平过于出现（over-presentation）。

GO/KEGG/GSEA/GSVA

# GO分析

GO富集分析原理：有一个term注释了100个差异表达基因参与了哪个过程，注释完之后（模式生物都有现成的注释包，不用我们自己注释），计算相对于背景它是否显著集中在某条通路、某一个细胞学定位、某一种生物学功能。

**对基因的描述一般从三个层面进行：**

- **Cellular component，CC 细胞成分**
- **Biological process， BP 生物学过程**
- **Molecular function，MF 分子功能**

这三个层面具体是指：

- **Cellular component解释的是**基因存在在哪里，在细胞质还是在细胞核？如果存在细胞质那在哪个细胞器上？如果是在线粒体中那是存在线粒体膜上还是在线粒体的基质当中？这些信息都叫Cellular component。
- **Biological process是在说明**该基因参与了哪些生物学过程，比如，它参与了rRNA的加工或参与了DNA的复制，这些信息都叫Biological process
- **Molecular function在讲**该基因在分子层面的功能是什么？它是催化什么反应的？
So, we will have a gene annotation infarmation.
立足于这三个方面，我们将得到基因的注释信息。

# **KEGG分析**

# GSEA分析

[RNA-seq入门实战（七）：GSEA——基因集富集分析 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/518144716)

- **基本原理**： 使用预定义的基因集（通常来自功能注释或先前实验的结果），将基因按照在两类样本中的差异表达程度排序，然后检验预先设定的基因集合是否在这个排序表的顶端或者底端富集。基因集合富集分析检测基因集合而不是单个基因的表达变化，因此可以包含这些细微的表达变化，预期得到更为理想的结果
- **与GO\KEGG差异基因富集分析区别**： 差异基因富集分析是先筛选差异基因，再判断差异基因在哪些注释的通路存在富集；这涉及到阈值的设定，存在一定主观性并且只能用于表达变化较大的基因，即我们定义的显著差异基因。而GSEA则不局限于差异基因，从基因集的富集角度出发，理论上**更容易囊括细微但协调性的变化对生物通路的影响**。
- **GSEA中关键概念**
    
    **ES（Enrichment Score）：富集得分** ES反应基因集成员s在排序列表L的两端富集的程度。计算方式是，从基因集L的第一个基因开始，计算一个累计统计值。当遇到一个落在s里面的基因，则增加统计值。遇到一个不在s里面的基因，则降低统计值。 每一步统计值增加或减少的幅度与基因的表达变化程度（fold-change值）是相关的。富集得分ES最后定义为最大的峰值。正值ES表示基因集在列表的顶部富集，负值ES表示基因集在列表的底部富集。 p-value用来评估富集得分(ES)的显著性，通过排列检验 (permutation test)计算观察到的富集得分(ES)出现的可能性。
    
    **NES (Normalized Enrichment Score)：标准化富集得分** 每个基因子集s计算得到的ES根据基因集的大小进行标准化得到标准化富集得分Normalized Enrichment Score (NES)。随后会针对NES计算假阳性率FDR。
    
    **Leading-edge subset：领头基因亚集** 对富集贡献最大的基因成员
    
    一般认为**|NES|>1，p-value<0.05，FDR<0.25**的通路是显著富集的。 |NES|值越大，FDR值就越小，说明分析的结果可信度越高。